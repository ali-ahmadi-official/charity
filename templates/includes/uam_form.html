<h5 style="margin-top: 20px;">HLA UAM: <input type="button" value="NO" class="uam"></h5>

<div class="my-grid" style="grid-template-columns: repeat(5, 1fr); display: none;" id="uam">
    <div>
        <label>{{ form.hla_a_uam.label }}</label>
        {{ form.hla_a_uam }}
        {% if form.hla_a_uam.errors %}
        {% for error in form.hla_a_uam.errors %}
        <p class="error">{{ error }}</p>
        {% endfor %}
        {% endif %}
    </div>
    <div>
        <label>{{ form.hla_b_uam.label }}</label>
        {{ form.hla_b_uam }}
        {% if form.hla_b_uam.errors %}
        {% for error in form.hla_b_uam.errors %}
        <p class="error">{{ error }}</p>
        {% endfor %}
        {% endif %}
    </div>
    <div>
        <label>{{ form.hla_drb1_uam.label }}</label>
        {{ form.hla_drb1_uam }}
        {% if form.hla_drb1_uam.errors %}
        {% for error in form.hla_drb1_uam.errors %}
        <p class="error">{{ error }}</p>
        {% endfor %}
        {% endif %}
    </div>
    <div>
        <label>{{ form.hla_drb_uam.label }}</label>
        {{ form.hla_drb_uam }}
        {% if form.hla_drb_uam.errors %}
        {% for error in form.hla_drb_uam.errors %}
        <p class="error">{{ error }}</p>
        {% endfor %}
        {% endif %}
    </div>
    <div>
        <label>{{ form.hla_dqb1_uam.label }}</label>
        {{ form.hla_dqb1_uam }}
        {% if form.hla_dqb1_uam.errors %}
        {% for error in form.hla_dqb1_uam.errors %}
        <p class="error">{{ error }}</p>
        {% endfor %}
        {% endif %}
    </div>
</div>

<script>
    const uam_btn = document.querySelector('.uam');
    const uam_lists = document.querySelector('#uam');

    uam_btn.addEventListener('click', () => {
        if (uam_btn.value == 'NO') {
            uam_btn.value = 'YES';
            uam_btn.classList.add('active-sort');
            uam_lists.style.display = 'grid';
        } else {
            uam_btn.value = 'NO';
            uam_btn.classList.remove('active-sort');
            uam_lists.style.display = 'none';

            const inputs = uam_lists.querySelectorAll('.uam_multi');
            inputs.forEach(input => {
                if (input.type === 'checkbox') {
                    input.checked = false;
                } else if (input.tagName.toLowerCase() === 'select' && input.multiple) {
                    for (let option of input.options) {
                        option.selected = false;
                    }
                }
            });
        }
    });

    window.addEventListener('DOMContentLoaded', () => {
        const inputs = uam_lists.querySelectorAll('.uam_multi');
        let hasSelection = false;

        inputs.forEach(input => {
            if (input.type === 'checkbox' && input.checked) {
                hasSelection = true;
            } else if (input.tagName.toLowerCase() === 'select' && input.multiple) {
                for (let option of input.options) {
                    if (option.selected) {
                        hasSelection = true;
                        break;
                    }
                }
            }
        });

        if (hasSelection) {
            uam_btn.value = 'YES';
            uam_btn.classList.add('active-sort');
            uam_lists.style.display = 'grid';
        } else {
            uam_btn.value = 'NO';
            uam_btn.classList.remove('active-sort');
            uam_lists.style.display = 'none';
        }
    });
</script>